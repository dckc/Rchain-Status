<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>RChain Status Demo</title>
  </head>
  <body>
    <h1>Setup</h1>
    <h2>Accessing a Node</h2>
    <p>This dapp requires access to a running RNode. You may find a puplically available node such as <code>rnode-test.rhobot.net</code> useful. Or, if you have the software installed locally, <code>npm run fresh</code> will start a fresh node for you.</p>

    <p>TODO: We should have textboxes to allow users to specify endpoint where their node is running and a button to make a new instance of RChain when they want to change nodes.</p>

    <h2>Deploying the contract(s)</h2>
    <p>We require the contract from status.rho to be deployed. If you're running a local node, <code>npm run deploy-contract</code> will do the job.</p>


    <h1>Your User Controls</h1>
    <p>Each user chooses a name. This name is the public channel on which you will send commands to update and check your status. Using a public name is a <strong>huge security hole</strong>, but alas, RNode does not have a working name registry yet. In the future, we will use unforgeable names.</p>
    <input id="name" type="text" />
    <button id="register">Register</button>

    <input id="new-status" type="text" />
    <button id="set-status">Post</button>

    <p>TODO The dapp should only enable one of register or post new depending on whether the name is registered. For now, we trust the user to use them correctly.</p>

    <h1>Check Friend's Satuses</h1>
    <p>What friend do you want to check on?</p>
    <input id="friend-name" type="text" />
    <button id="check-status">Check</button>
    <p>Your friend's status is: <span id="friend-status"></p>

    <h1>Force Propose</h1>
    <p>If your node is taking too long to propose a block, you can force it.</p>
    <button id="propose">Propose Block Now</button>

<script type="module">
import statusPage from './page.js';

window.addEventListener("DOMContentLoaded", () => {
  const byId = id => document.getElementById(id);
  const ui = {
    nameBox: byId("name"),
    registerButton: byId("register"),
    newStatusBox: byId("new-status"),
    setStatusButton: byId("set-status"),

    friendBox: byId("friend-name"),
    checkButton: byId("check-status"),
    friendStatusP: byId("friend-status"),

    proposeButton: byId("propose"),
  };

  statusPage(ui, fetch);
});

</script>
  </body>
</html>
